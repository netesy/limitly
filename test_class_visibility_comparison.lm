// Test case: Comparing class member visibility between same-module and imported classes
// This demonstrates the difference in visibility enforcement

// ===== SAME MODULE CLASSES =====

// Define a class in this module with different visibility levels
class LocalPerson {
    pub name: str;        // Public - accessible everywhere
    prot age: int;        // Protected - accessible in same module and subclasses
    ssn: str;            // Private - accessible only in same module
    
    fn init(name: str, age: int, ssn: str) {
        self.name = name;
        self.age = age;
        self.ssn = ssn;
    }
    
    pub fn getName(): str {
        return self.name;
    }
    
    prot fn getAge(): int {
        return self.age;
    }
    
    fn getSSN(): str {    // Private method
        return self.ssn;
    }
}

// Another class in the same module
class LocalEmployee : LocalPerson {
    salary: float;       // Private by default
    
    fn init(name: str, age: int, ssn: str, salary: float) {
        super.init(name, age, ssn);
        self.salary = salary;
    }
    
    pub fn displayLocalInfo() {
        // Same module access - should work for all visibility levels
        print("Local Name: {self.name}");      // Public - OK
        print("Local Age: {self.age}");        // Protected - OK (subclass)
        print("Local SSN: {self.ssn}");        // Private - OK (same module)
        
        // Method calls
        print("Local getName(): {self.getName()}");    // Public - OK
        print("Local getAge(): {self.getAge()}");      // Protected - OK (subclass)
        print("Local getSSN(): {self.getSSN()}");      // Private - OK (same module)
    }
}

// Function in same module accessing class members
fn accessLocalClassMembers() {
    var person = LocalPerson("Alice", 25, "123-45-6789");
    
    // Same module access rules:
    print("Same module public: {person.name}");     // Should work - public
    print("Same module protected: {person.age}");   // Should work - same module
    print("Same module private: {person.ssn}");     // Should work - same module
    
    // Method calls in same module:
    print("Same module public method: {person.getName()}");   // Should work
    print("Same module protected method: {person.getAge()}"); // Should work - same module
    print("Same module private method: {person.getSSN()}");   // Should work - same module
}

// ===== IMPORTED CLASSES =====

// Import classes from another module
import person_module show Person, Employee;

// Function accessing imported class members
fn accessImportedClassMembers() {
    var person = Person("Bob", 30, "987-65-4321");
    
    // Cross-module access rules:
    print("Cross-module public: {person.name}");     // Should work - public
    
    // These should be caught by type_checker at compile-time:
    print("Cross-module protected: {person.age}");   // ERROR - protected across modules
    print("Cross-module private: {person.ssn}");     // ERROR - private across modules
    
    // Method calls across modules:
    print("Cross-module public method: {person.getName()}");   // Should work
    
    // These should be caught by type_checker at compile-time:
    print("Cross-module protected method: {person.getAge()}"); // ERROR - protected method
    print("Cross-module private method: {person.getSSN()}");   // ERROR - private method
}

// Class in this module inheriting from imported class
class LocalManager : Person {
    department: str;
    
    fn init(name: str, age: int, ssn: str, department: str) {
        super.init(name, age, ssn);
        self.department = department;
    }
    
    pub fn displayManagerInfo() {
        // Inheritance across modules:
        print("Manager name: {self.name}");      // Should work - public
        print("Manager age: {self.age}");        // Should work - protected in subclass
        
        // This should be caught by type_checker at compile-time:
        print("Manager SSN: {self.ssn}");        // ERROR - private not accessible across modules
    }
}

// ===== EXPECTED BEHAVIOR SUMMARY =====
/*
SAME MODULE ACCESS (LocalPerson, LocalEmployee):
- Public members: ✓ Accessible everywhere
- Protected members: ✓ Accessible in same module and subclasses  
- Private members: ✓ Accessible in same module

CROSS-MODULE ACCESS (Person from person_module):
- Public members: ✓ Accessible everywhere
- Protected members: ✗ NOT accessible across modules (except in subclasses)
- Private members: ✗ NOT accessible across modules

INHERITANCE ACROSS MODULES (LocalManager extends Person):
- Public members: ✓ Accessible in subclass
- Protected members: ✓ Accessible in subclass (inheritance rule)
- Private members: ✗ NOT accessible in subclass across modules

The type_checker should enforce these rules at compile-time,
not at runtime in the VM.
*/

// Execute tests
accessLocalClassMembers();
accessImportedClassMembers();

var manager = LocalManager("Charlie", 35, "555-12-3456", "Engineering");
manager.displayManagerInfo();

var employee = LocalEmployee("David", 28, "777-88-9999", 75000.0);
employee.displayLocalInfo();