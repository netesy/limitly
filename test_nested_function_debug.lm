print("=== Testing Nested Function Issues ===");

print("\nðŸ”¹ Test 1: Simple nested function (should work)");
fn createSimple(): function {
    return fn(x: int): int {
        return x + 1;
    };
}

var simple = createSimple();
print("Simple nested function created successfully");

print("\nðŸ”¹ Test 2: Double nested function (may cause issues)");
fn createDouble(): function {
    return fn(): function {
        return fn(x: int): int {
            return x * 2;
        };
    };
}

var doubleNested = createDouble();
print("Double nested function created successfully");

print("\nðŸ”¹ Test 3: Triple nested function (likely to cause END_FUNCTION error)");
fn createTriple(): function {
    return fn(): function {
        return fn(): function {
            return fn(x: int): int {
                return x * 3;
            };
        };
    };
}

var tripleNested = createTriple();
print("Triple nested function created successfully");

print("\nðŸ”¹ Test 4: Deep nesting (6+ levels - should trigger PUSH_LAMBDA error)");
fn level1(): function {
    return fn(): function {
        return fn(): function {
            return fn(): function {
                return fn(): function {
                    return fn(): function {
                        return fn(x: int): int {
                            return x + 42;
                        };
                    };
                };
            };
        };
    };
}

var deepNested = level1();
print("Deep nested function created successfully");

print("\n=== All nested function tests completed ===");