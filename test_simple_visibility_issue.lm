// Simple demonstration of the visibility issue

// ===== SAME MODULE CLASS =====
class LocalPerson {
    pub name: str;        // Public
    prot age: int;        // Protected  
    ssn: str;            // Private
    
    pub fn init(name: str, age: int, ssn: str) {
        self.name = name;
        self.age = age;
        self.ssn = ssn;
    }
}

// Function in SAME MODULE - should have access to ALL visibility levels
fn testSameModuleAccess() {
    var person = LocalPerson("Alice", 25, "123-45-6789");
    
    print("=== SAME MODULE ACCESS ===");
    print("Current behavior: VM blocks protected/private at RUNTIME");
    print("Expected behavior: Type_checker should ALLOW all access in same module");
    print("");
    
    // Public access - works
    print("Public name: " + person.name);
    
    // Protected access - SHOULD work in same module but VM blocks it at runtime
    print("Trying protected age...");
    // print("Protected age: " + person.age);  // This fails at RUNTIME but should work
    
    // Private access - SHOULD work in same module but VM blocks it at runtime  
    print("Trying private ssn...");
    // print("Private ssn: " + person.ssn);   // This fails at RUNTIME but should work
}

// ===== CROSS-MODULE ACCESS =====
import simple_person_module show Person;

fn testCrossModuleAccess() {
    var person = Person("Bob", 30, "987-65-4321");
    
    print("=== CROSS MODULE ACCESS ===");
    print("Current behavior: VM blocks protected/private at RUNTIME");
    print("Expected behavior: Type_checker should block at COMPILE-TIME");
    print("");
    
    // Public access - should work
    print("Public name: " + person.name);
    
    // Protected/private access - should be COMPILE-TIME errors
    print("Trying protected age...");
    // print("Protected age: " + person.age);  // Should be compile-time error
    
    print("Trying private ssn...");
    // print("Private ssn: " + person.ssn);   // Should be compile-time error
}

print("=== VISIBILITY ISSUE DEMONSTRATION ===");
print("");
print("THE PROBLEM:");
print("1. Same-module access: VM incorrectly blocks protected/private at RUNTIME");
print("2. Cross-module access: VM blocks at RUNTIME instead of type_checker at COMPILE-TIME");
print("3. Type_checker is not enforcing visibility rules properly");
print("");

testSameModuleAccess();
print("");
testCrossModuleAccess();

print("");
print("SOLUTION NEEDED:");
print("1. Enhance type_checker.checkMemberAccess() to distinguish same-module vs cross-module");
print("2. Allow same-module access to all visibility levels");
print("3. Block cross-module access to non-public members at compile-time");
print("4. Remove or modify VM runtime visibility checks");