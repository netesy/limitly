// Core visibility issue demonstration:
// Same-module vs cross-module access should be handled at COMPILE-TIME

// ===== SAME MODULE CLASS =====
class LocalPerson {
    pub name: str;        // Public
    prot age: int;        // Protected  
    ssn: str;            // Private
    
    pub fn init(name: str, age: int, ssn: str) {
        self.name = name;
        self.age = age;
        self.ssn = ssn;
    }
    
    pub fn getName(): str {
        return self.name;
    }
    
    prot fn getAge(): int {
        return self.age;
    }
    
    fn getSSN(): str {    // Private
        return self.ssn;
    }
}

// Function in SAME MODULE - should have access to ALL visibility levels
fn testSameModuleAccess() {
    let person = LocalPerson("Alice", 25, "123-45-6789");
    
    print("=== SAME MODULE ACCESS (should all work) ===");
    
    // These should ALL work because we're in the same module
    print("Public: " + person.name);        // ✓ Should work
    print("Protected: " + person.age);      // ✓ Should work (same module)
    print("Private: " + person.ssn);        // ✓ Should work (same module)
    
    print("Public method: " + person.getName());    // ✓ Should work
    print("Protected method: " + person.getAge());  // ✓ Should work (same module)
    print("Private method: " + person.getSSN());    // ✓ Should work (same module)
}

// ===== CROSS-MODULE ACCESS =====
import person_module show Person;

fn testCrossModuleAccess() {
    let person = Person("Bob", 30, "987-65-4321");
    
    print("=== CROSS MODULE ACCESS ===");
    
    // Only public should work across modules
    print("Public: " + person.name);        // ✓ Should work
    
    // These should be COMPILE-TIME errors, not runtime errors
    print("Protected: " + person.age);      // ✗ Should be blocked by type_checker
    print("Private: " + person.ssn);        // ✗ Should be blocked by type_checker
    
    print("Public method: " + person.getName());    // ✓ Should work
    print("Protected method: " + person.getAge());  // ✗ Should be blocked by type_checker
    print("Private method: " + person.getSSN());    // ✗ Should be blocked by type_checker
}

// ===== CURRENT PROBLEM =====
/*
ISSUE: The type_checker is NOT enforcing visibility rules at compile-time.
Instead, the VM is catching these at runtime.

EXPECTED BEHAVIOR:
1. Same-module access: type_checker should ALLOW all visibility levels
2. Cross-module access: type_checker should BLOCK non-public members at COMPILE-TIME
3. No runtime visibility errors should occur if type_checker works correctly

CURRENT BEHAVIOR:
1. Same-module access: VM blocks protected/private at RUNTIME (wrong!)
2. Cross-module access: VM blocks protected/private at RUNTIME (should be compile-time!)
3. Type_checker is not doing its job for visibility enforcement
*/

print("Starting visibility tests...");
testSameModuleAccess();
testCrossModuleAccess();
print("Visibility tests completed.");