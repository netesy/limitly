Bytecode for C:\Projects\limitly\tests\classes\basic_classes.lm
Parser: New CSTParser
========================================

=== Bytecode ===
Generated 283 instructions

   0: PUSH_STRING          "=== Basic Class Tests ==="
   1: PRINT               
   2: BEGIN_CLASS          "Person"
   3: BEGIN_FUNCTION       "init"
   4: DEFINE_PARAM        
   5: DEFINE_PARAM        
   6: BEGIN_SCOPE         
   7: LOAD_THIS           
   8: LOAD_VAR             "name"
   9: SET_PROPERTY         "name"
  10: POP                 
  11: LOAD_THIS           
  12: LOAD_VAR             "age"
  13: SET_PROPERTY         "age"
  14: POP                 
  15: END_SCOPE           
  16: PUSH_NULL           
  17: RETURN              
  18: END_FUNCTION        
  19: PUSH_FUNCTION       
  20: STORE_VAR            "init"
  21: BEGIN_FUNCTION       "greet"
  22: BEGIN_SCOPE         
  23: PUSH_STRING         
  24: LOAD_THIS           
  25: GET_PROPERTY         "name"
  26: PUSH_STRING         
  27: CONCAT              
  28: LOAD_THIS           
  29: GET_PROPERTY         "age"
  30: PUSH_STRING         
  31: CONCAT              
  32: PUSH_STRING          " years old"
  33: INTERPOLATE_STRING  
  34: PRINT               
  35: END_SCOPE           
  36: PUSH_NULL           
  37: RETURN              
  38: END_FUNCTION        
  39: PUSH_FUNCTION       
  40: STORE_VAR            "greet"
  41: BEGIN_FUNCTION       "birthday"
  42: BEGIN_SCOPE         
  43: LOAD_THIS           
  44: PUSH_INT             1
  45: SET_PROPERTY         "age"
  46: POP                 
  47: PUSH_STRING         
  48: LOAD_THIS           
  49: GET_PROPERTY         "name"
  50: PUSH_STRING         
  51: CONCAT              
  52: LOAD_THIS           
  53: GET_PROPERTY         "age"
  54: PUSH_STRING         
  55: CONCAT              
  56: PUSH_STRING          " years old"
  57: INTERPOLATE_STRING  
  58: PRINT               
  59: END_SCOPE           
  60: PUSH_NULL           
  61: RETURN              
  62: END_FUNCTION        
  63: PUSH_FUNCTION       
  64: STORE_VAR            "birthday"
  65: END_CLASS           
  66: PUSH_STRING          "Creating Person objects:"
  67: PRINT               
  68: PUSH_STRING          "Alice"
  69: PUSH_INT             25
  70: CALL                 "Person"
  71: STORE_VAR            "person1"
  72: PUSH_STRING          "Bob"
  73: PUSH_INT             30
  74: CALL                 "Person"
  75: STORE_VAR            "person2"
  76: PUSH_STRING          "Calling methods:"
  77: PRINT               
  78: LOAD_VAR             "person1"
  79: GET_PROPERTY         "greet"
  80: CALL                
  81: POP                 
  82: LOAD_VAR             "person2"
  83: GET_PROPERTY         "greet"
  84: CALL                
  85: POP                 
  86: PUSH_STRING          "Birthday test:"
  87: PRINT               
  88: LOAD_VAR             "person1"
  89: GET_PROPERTY         "birthday"
  90: CALL                
  91: POP                 
  92: LOAD_VAR             "person1"
  93: GET_PROPERTY         "greet"
  94: CALL                
  95: POP                 
  96: BEGIN_CLASS          "Rectangle"
  97: PUSH_INT             0
  98: DEFINE_FIELD         "width"
  99: PUSH_INT             0
 100: DEFINE_FIELD         "height"
 101: BEGIN_FUNCTION       "init"
 102: DEFINE_PARAM        
 103: DEFINE_PARAM        
 104: BEGIN_SCOPE         
 105: LOAD_THIS           
 106: LOAD_VAR             "width"
 107: SET_PROPERTY         "width"
 108: POP                 
 109: LOAD_THIS           
 110: LOAD_VAR             "height"
 111: SET_PROPERTY         "height"
 112: POP                 
 113: END_SCOPE           
 114: PUSH_NULL           
 115: RETURN              
 116: END_FUNCTION        
 117: PUSH_FUNCTION       
 118: STORE_VAR            "init"
 119: BEGIN_FUNCTION       "area"
 120: BEGIN_SCOPE         
 121: LOAD_THIS           
 122: GET_PROPERTY         "width"
 123: LOAD_THIS           
 124: GET_PROPERTY         "height"
 125: MULTIPLY            
 126: RETURN              
 127: END_SCOPE           
 128: PUSH_NULL           
 129: RETURN              
 130: END_FUNCTION        
 131: PUSH_FUNCTION       
 132: STORE_VAR            "area"
 133: BEGIN_FUNCTION       "perimeter"
 134: BEGIN_SCOPE         
 135: PUSH_INT             2
 136: LOAD_THIS           
 137: GET_PROPERTY         "width"
 138: LOAD_THIS           
 139: GET_PROPERTY         "height"
 140: ADD                 
 141: MULTIPLY            
 142: RETURN              
 143: END_SCOPE           
 144: PUSH_NULL           
 145: RETURN              
 146: END_FUNCTION        
 147: PUSH_FUNCTION       
 148: STORE_VAR            "perimeter"
 149: END_CLASS           
 150: PUSH_STRING          "Rectangle class:"
 151: PRINT               
 152: PUSH_INT             5
 153: PUSH_INT             3
 154: CALL                 "Rectangle"
 155: STORE_VAR            "rect"
 156: PUSH_STRING         
 157: LOAD_VAR             "rect"
 158: GET_PROPERTY         "area"
 159: CALL                
 160: PUSH_STRING         
 161: CONCAT              
 162: PUSH_STRING          ""Area: {rect.area()}"
 163: INTERPOLATE_STRING  
 164: PRINT               
 165: PUSH_STRING         
 166: LOAD_VAR             "rect"
 167: GET_PROPERTY         "perimeter"
 168: CALL                
 169: PUSH_STRING         
 170: CONCAT              
 171: PUSH_STRING          ""Perimeter: {rect.perimeter()}"
 172: INTERPOLATE_STRING  
 173: PRINT               
 174: BEGIN_CLASS          "BankAccount"
 175: PUSH_FLOAT           0
 176: DEFINE_FIELD         "balance"
 177: BEGIN_FUNCTION       "deposit"
 178: DEFINE_PARAM        
 179: BEGIN_SCOPE         
 180: LOAD_THIS           
 181: LOAD_THIS           
 182: GET_PROPERTY         "balance"
 183: LOAD_VAR             "amount"
 184: ADD                 
 185: SET_PROPERTY         "balance"
 186: POP                 
 187: LOAD_THIS           
 188: GET_PROPERTY         "balance"
 189: RETURN              
 190: END_SCOPE           
 191: PUSH_NULL           
 192: RETURN              
 193: END_FUNCTION        
 194: PUSH_FUNCTION       
 195: STORE_VAR            "deposit"
 196: BEGIN_FUNCTION       "withdraw"
 197: DEFINE_PARAM        
 198: BEGIN_SCOPE         
 199: LOAD_VAR             "amount"
 200: LOAD_THIS           
 201: GET_PROPERTY         "balance"
 202: GREATER             
 203: JUMP_IF_FALSE        8
 204: BEGIN_SCOPE         
 205: PUSH_STRING          "Insufficient funds!"
 206: PRINT               
 207: LOAD_THIS           
 208: GET_PROPERTY         "balance"
 209: RETURN              
 210: END_SCOPE           
 211: JUMP                 0
 212: LOAD_THIS           
 213: LOAD_THIS           
 214: GET_PROPERTY         "balance"
 215: LOAD_VAR             "amount"
 216: SUBTRACT            
 217: SET_PROPERTY         "balance"
 218: POP                 
 219: LOAD_VAR             "amount"
 220: RETURN              
 221: END_SCOPE           
 222: PUSH_NULL           
 223: RETURN              
 224: END_FUNCTION        
 225: PUSH_FUNCTION       
 226: STORE_VAR            "withdraw"
 227: END_CLASS           
 228: BEGIN_FUNCTION       "test_bank_account"
 229: BEGIN_SCOPE         
 230: CALL                 "BankAccount"
 231: STORE_VAR            "account"
 232: LOAD_VAR             "account"
 233: GET_PROPERTY         "deposit"
 234: CALL                
 235: POP                 
 236: PUSH_STRING         
 237: LOAD_VAR             "account"
 238: GET_PROPERTY         "balance"
 239: PUSH_STRING         
 240: CONCAT              
 241: PUSH_STRING          ""Balance after deposit: {account.balance}"
 242: INTERPOLATE_STRING  
 243: PRINT               
 244: LOAD_VAR             "account"
 245: GET_PROPERTY         "withdraw"
 246: CALL                
 247: STORE_VAR            "withdrawn"
 248: PUSH_STRING         
 249: LOAD_VAR             "withdrawn"
 250: PUSH_STRING         
 251: CONCAT              
 252: PUSH_STRING          ""Withdrawn: {withdrawn}"
 253: INTERPOLATE_STRING  
 254: PRINT               
 255: PUSH_STRING         
 256: LOAD_VAR             "account"
 257: GET_PROPERTY         "balance"
 258: PUSH_STRING         
 259: CONCAT              
 260: PUSH_STRING          ""Balance after withdrawal: {account.balance}"
 261: INTERPOLATE_STRING  
 262: PRINT               
 263: LOAD_VAR             "account"
 264: GET_PROPERTY         "withdraw"
 265: CALL                
 266: STORE_VAR            "failed_withdraw"
 267: PUSH_STRING         
 268: LOAD_VAR             "failed_withdraw"
 269: PUSH_STRING         
 270: CONCAT              
 271: PUSH_STRING          ""Failed withdrawal: {failed_withdraw}"
 272: INTERPOLATE_STRING  
 273: PRINT               
 274: END_SCOPE           
 275: PUSH_NULL           
 276: RETURN              
 277: END_FUNCTION        
 278: PUSH_FUNCTION       
 279: STORE_VAR            "test_bank_account"
 280: CALL                 "test_bank_account"
 281: POP                 
 282: HALT                

