AST for tests\functions\higher_order_functions.lm
Parser: New Unified Parser (CST mode)
Mode: CST with AST compatibility
Note: CST nodes were created internally with trivia preservation
      AST output shown below for compatibility testing
========================================

AST Dump:
==========
PrintStatement:
  Literal: === Higher-Order Functions Tests ===
PrintStatement:
  Literal: 
--- Test 1: Function as Parameter ---
FunctionDeclaration: applyOperation
  Parameters:
    x: int
    y: int
    operation: () -> int
  ReturnType: int
  Body:
    BlockStatement:
      ReturnStatement:
        Value:
          CallExpression:
            Callee:
              Variable: operation
            Arguments:
              Variable: x
              Variable: y
FunctionDeclaration: add
  Parameters:
    a: int
    b: int
  ReturnType: int
  Body:
    BlockStatement:
      ReturnStatement:
        Value:
          BinaryExpression: +
            Left:
              Variable: a
            Operator: +
            Right:
              Variable: b
FunctionDeclaration: multiply
  Parameters:
    a: int
    b: int
  ReturnType: int
  Body:
    BlockStatement:
      ReturnStatement:
        Value:
          BinaryExpression: *
            Left:
              Variable: a
            Operator: *
            Right:
              Variable: b
VarDeclaration: addResult
  Initializer:
    CallExpression:
      Callee:
        Variable: applyOperation
      Arguments:
        Literal: 5
        Literal: 3
        Variable: add
PrintStatement:
  BinaryExpression: +
    Left:
      Literal: applyOperation(5, 3, add) = 
    Operator: +
    Right:
      Variable: addResult
VarDeclaration: multiplyResult
  Initializer:
    CallExpression:
      Callee:
        Variable: applyOperation
      Arguments:
        Literal: 5
        Literal: 3
        Variable: multiply
PrintStatement:
  BinaryExpression: +
    Left:
      Literal: applyOperation(5, 3, multiply) = 
    Operator: +
    Right:
      Variable: multiplyResult
PrintStatement:
  Literal: 
--- Test 2: Function Returning Function ---
FunctionDeclaration: createAdder
  Parameters:
    increment: int
  ReturnType: () -> int
  Body:
    BlockStatement:
      ReturnStatement:
        Value:
          LambdaExpression:
            Parameters:
              x: int
            ReturnType: int
            Body:
              BlockStatement:
                ReturnStatement:
                  Value:
                    BinaryExpression: +
                      Left:
                        Variable: x
                      Operator: +
                      Right:
                        Variable: increment
VarDeclaration: addFive
  Initializer:
    CallExpression:
      Callee:
        Variable: createAdder
      Arguments:
        Literal: 5
VarDeclaration: result1
  Initializer:
    CallExpression:
      Callee:
        Variable: addFive
      Arguments:
        Literal: 10
PrintStatement:
  BinaryExpression: +
    Left:
      Literal: addFive(10) = 
    Operator: +
    Right:
      Variable: result1
VarDeclaration: addTen
  Initializer:
    CallExpression:
      Callee:
        Variable: createAdder
      Arguments:
        Literal: 10
VarDeclaration: result2
  Initializer:
    CallExpression:
      Callee:
        Variable: addTen
      Arguments:
        Literal: 20
PrintStatement:
  BinaryExpression: +
    Left:
      Literal: addTen(20) = 
    Operator: +
    Right:
      Variable: result2
PrintStatement:
  Literal: 
--- Test 3: Nested Higher-Order Functions ---
FunctionDeclaration: createMultiplier
  Parameters:
    factor: int
  ReturnType: () -> int
  Body:
    BlockStatement:
      ReturnStatement:
        Value:
          LambdaExpression:
            Parameters:
              x: int
            ReturnType: int
            Body:
              BlockStatement:
                ReturnStatement:
                  Value:
                    BinaryExpression: *
                      Left:
                        Variable: x
                      Operator: *
                      Right:
                        Variable: factor
FunctionDeclaration: applyTwice
  Parameters:
    f: () -> int
    x: int
  ReturnType: int
  Body:
    BlockStatement:
      ReturnStatement:
        Value:
          CallExpression:
            Callee:
              Variable: f
            Arguments:
              CallExpression:
                Callee:
                  Variable: f
                Arguments:
                  Variable: x
VarDeclaration: double
  Initializer:
    CallExpression:
      Callee:
        Variable: createMultiplier
      Arguments:
        Literal: 2
VarDeclaration: quadrupleResult
  Initializer:
    CallExpression:
      Callee:
        Variable: applyTwice
      Arguments:
        Variable: double
        Literal: 3
PrintStatement:
  BinaryExpression: +
    Left:
      Literal: applyTwice(double, 3) = 
    Operator: +
    Right:
      Variable: quadrupleResult
PrintStatement:
  Literal: 
--- Test 4: Function Composition ---
FunctionDeclaration: compose
  Parameters:
    f: () -> int
    g: () -> int
  ReturnType: () -> int
  Body:
    BlockStatement:
      ReturnStatement:
        Value:
          LambdaExpression:
            Parameters:
              x: int
            ReturnType: int
            Body:
              BlockStatement:
                ReturnStatement:
                  Value:
                    CallExpression:
                      Callee:
                        Variable: f
                      Arguments:
                        CallExpression:
                          Callee:
                            Variable: g
                          Arguments:
                            Variable: x
FunctionDeclaration: square
  Parameters:
    x: int
  ReturnType: int
  Body:
    BlockStatement:
      ReturnStatement:
        Value:
          BinaryExpression: *
            Left:
              Variable: x
            Operator: *
            Right:
              Variable: x
FunctionDeclaration: increment
  Parameters:
    x: int
  ReturnType: int
  Body:
    BlockStatement:
      ReturnStatement:
        Value:
          BinaryExpression: +
            Left:
              Variable: x
            Operator: +
            Right:
              Literal: 1
VarDeclaration: squareThenIncrement
  Initializer:
    CallExpression:
      Callee:
        Variable: compose
      Arguments:
        Variable: increment
        Variable: square
VarDeclaration: compositionResult
  Initializer:
    CallExpression:
      Callee:
        Variable: squareThenIncrement
      Arguments:
        Literal: 4
PrintStatement:
  BinaryExpression: +
    Left:
      Literal: squareThenIncrement(4) = 
    Operator: +
    Right:
      Variable: compositionResult
PrintStatement:
  Literal: 
=== Higher-Order Functions Tests Complete ===
